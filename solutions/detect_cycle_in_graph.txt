Use DFS with visited and recursion stack or Union-Find for cycle detection.